---=memory=---

dirty pages          - грязные страницы памяти. Данные загруженные в память не соответствуют тем, которые находятся на диске.
Пример: редактирование файла в text editor

Кэш                  - память для хранения файлов

Анонимные страницы   - данные у которых нет отображения на диске, т.е. нет соответствия файлу на диске
Пример: результат работы программы в процессе

Файловые страницы    - данные у которых есть отображение на диске, т.е. находятся на диске

buffer               - Память для хранения разбитых на части (куски) данных 
Пример: Используется для обработки больших данных (компановка файлов)

swap                 - используется для выгрузки анонимных страниц памяти

Старницы памяти бывают:
Активыне и неактивные страницы памяти. Первыми на выгрузку из ОЗУ идут неактивные



Команды:

Сброс кэша: 
echo 1\2\3 > /proc/sys/vm/drop_caches

Подробная информация по памяти:
cat /proc/meminfo
расшифровка
	| grep dirty                                 // грязные страницы памяти 
sync                                             // утилита cинхронизировать (скинуть) грязные страницы памяти на диск
	inactive = inactive (anon); inactive (file)  // первое что пойдёт на выгрузку из памяти, anon (анонимные) страницы не имееют файлов на диске (появляются в процессе работы процесса), anon идёт в SWAP
	SwapChached                                  // сколько страниц было выгружено из SWAP в память (обратно)

cat /proc/_id_process_/oom_score                 // счетчик запуска oom killer для процесса

swapon -s (инфа по swap)

SWAPPINESS
cat /proc/sys/vm/swappiness                      // соотношение (file pages к anon pages) выгрузки страниц из памяти, 0-100 (%), по умолчанию 60. когда 60% файловых страниц будет выгружено, начнётся выгрузка анонимных страниц. Если 100, то будут одновременно выгружаться файл и анон страницы

cat /proc/zoneinfo                               // из архитектуры процессоров: DMA, DMA32 (low, high) активация работы выгрузки в swap 

Сбросить грязные страницы памяти на диск:
sync

Очистить SWAP:
swapoff

Пасширенная информация о системе:
vmstat -a

free -h
расшифровка
free (инфа память) -k -m -h
total = вся ОЗУ - kernel_linux_loaded
used = используется программами
free = ненужная память
shared = пямять для обмена данными между процессами
buffer\cashe
available = память доступная для использования


Краткая информация по памяти:
Страницы памяти по 4кб

Slab cache - плитки памяти, используются для данных, которые менее 4кб, что бы не аллоцироватт память (это долгая операция). Посмотреть инфо: slabtop

Кэш
В Linux есть несколько видов кэшей:
dirty cache — блоки данных, которые еще не записаны на диск (в файловых системах, поддерживающих кэширование, например, ext4). Этот кэш можно очистить командой sync. Очистка этого кэша может привести к снижению производительности. При обычном режиме работы не стоит этого делать, если только вам не нужно сбросить данные на жесткий диск, например, при аварии.
clean cache — блоки данных, которые для ускорения доступа находятся и на жестком диске и в памяти. Очистка clean cache может привести к снижению производительности, поскольку все данные будут считываться с диска.
inode cache — кэш информации о местоположении inode. Его можно очистить аналогично clean cache, но также с последующим снижением производительности.
slab cache — хранит объекты, выделенные приложениям с помощью malloc, таким образом, что в будущем они могут быть повторно выделены с уже заполненными данными объекта, что ускоряет выделение памяти.

Очистка Кеша:
# clear page cache (above type 2 and 3)
$ echo 1 > /proc/sys/vm/drop_caches
# clear slab cache (above type 4)
$ echo 2 > /proc/sys/vm/drop_caches
# clear page and slab cache (types 2,3,4)
$ echo 3 > /proc/sys/vm/drop_caches

Плохо если:
Slab кэш > 10%
Анонимные страницы > 80%
Грязные страницы > ???


Все изменения для постоянной основы надо вносить в: /etc/sysctl.conf




