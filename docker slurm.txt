docker run -i -t debian:jessie bash
Под капотом выполняет:
docker pull debian:jessie
docer create debian:jessie bash
docker start _containerID_

docker ps -a

docker run -d -p 8080:80 nginx:1.13
8080 локальны порт пробрасывается в
80 порт контейнера
curl -i localhost:8080

docker log _containerName_

docker exec _containerName_ cat /etc/nginx/conf.d/default.conf

docker rm -f _containerName_

docker run -d -p 8080:80 -v $PWD/default.conf:/etc/nginx/conf.d/default.conf nginx:1.13

docker run -e 'VARIABLE=value' nginx:1.12



docker build . -t myImage

docker images


Dockerfile 1:
FROM python:3.6
RUN ln -snf /usr/share/zoneinfo/Europe/Moscow /etc/localtime && echo Europe/Moscow > /etc/timezone

RUN apt-get update -y && apt-get install -y curl
RUN pip install django

ADD . /app
ENTRYPOINT python /app/manage.py runserver 0.0.0.0:8000 --noreload



! Процессы с программой лучше всего не запускать в фоне (background), а запускать в foreground
! Из образа полезно удалять кеши пакетного менеджера
! Важен порядок дериктив, при изменении одного слоя, все последующие будут пересобираться
Логи внутри контейнира лучше писать в stdout\stderr

Dockerfile 2:
EXPOSE 80          // По умолчанию контейнер будет открывать порт 80
ENTRYPOINT nginx -g 'daemon off;'    // запускать nginx в foreground

COPY vs ADD        // COPY просто копирует
                   // ADD коприрует, скачивает файлы по url, архивы распаковывает.
                   !! Рекомендуется использовать COPY

ENTRYPOINT vs CMD  // ENTRYPOINT команда выполняющаяся при старте контейнера (запуск приложения) *нельзя переопределить при запуске контейнера # предполагалось изначально
                   // CMD ключи и параметры для команды (ключи\параметры запуска приложения) *можно переопределить при запуске контейнера # предполагалось изначально
                   ENTRYPOINT имеет два режима выполнения:
                   ENTRYPOINT ["executable", "param1", "param2"] (исполняемая форма, предпочтительно)   # "exec" format 
                   ENTRYPOINT command param1 param2 (форма оболочки)    # "shell" format                           
                   Режим exec является рекомендуемым

Файл
.dockerignore:
.git



Dockerfile 3: (задание)
FROM python:3.11.3-buster

RUN set -ex && apt-get update -y && apt-get upgrade -y && apt-get clean
RUN mkdir /app && useradd -m app && chown app:app /app

USER app

COPY . /app

RUN cd /app && pip install -r requirements.txt

EXPOSE 8000

CMD python /app/app.py




Полезные параметры запуска docker daemon
--default-ulimit
--dns
--insecure-registry

